erDiagram
    %% === CORE ENTITIES ===
    INSTITUTION {
        string _id
        string name
        string country
        string city
        string email
        string domain
        string slug
        date createdAt
    }

    USER {
        string _id
        string institutionId FK
        string firstNames
        string lastNames
        string department
        string email
        string passwordHash
        string role "super-admin | admin | professor | student"
        boolean isAdmin "for professors who have admin privileges"
        boolean needsToConfigurePass
        date createdAt
    }

    EVENT {
        string _id
        string userOrigin FK
        string userDestination
        string title
        string contents
        boolean wasRead
        date createdAt
        date readAt
    }

    INSTITUTION_REQUEST {
        string _id
        string institutionName
        string requesterEmail
        string status "pending | approved | rejected"
        date createdAt
    }

    PROFESSOR_REQUEST {
        string _id
        string institutionId FK
        string professorEmail
        string professorName
        string status "pending | approved | rejected"
        date createdAt
    }

    %% === ACADEMIC STRUCTURE ===
    CLASS {
        string _id
        string professorId FK
        string institutionId FK
        string name
        string semester
        date createdAt
    }

    GROUP {
        string _id
        string classId FK
        string name
        string semesterCode
        string semester "Aug-Dec25" | "Feb-Jun26"
        date createdAt
    }

    GAME {
        string _id
        string groupId FK
        string professorId FK
        string name
        string code // "for student join"
        string status "draft | active | ended"
        string configurationId FK
        date createdAt
    }

    GAME_CONFIGURATION {
        string _id
        string gameId FK
        string premisesId FK
        string ordersConfigId FK
        string availableMachineryIds[]
        string availableEmployeeIds[]
        string availableBOMIds[]
        date createdAt
    }

    %% === CONFIG REFERENCE TABLES ===
    PREMISES {
        string _id
        string name
        number area
        number rentCost
        number powerCapacity
    }

    ORDER_CONFIG {
        string _id
        string productType
        number initialOrders
        number demandRate
    }

    MACHINERY {
        string _id
        string name
        string type
        number cost
        number maintenanceCost
        number productionRate
    }

    EMPLOYEE {
        string _id
        string name
        string jobTitle
        number salary
        number efficiency
    }

    BOM {
        string _id
        string productName
        string[] requiredMaterials
        number materialCost
    }

    %% === GAME-SPECIFIC CUSTOMIZED CONFIGS ===
    GAME_MACHINERY {
        string _id
        string gameId FK
        string baseMachineryId FK
        number customCost
        number customEfficiency
    }

    GAME_EMPLOYEE {
        string _id
        string gameId FK
        string baseEmployeeId FK
        number customSalary
        number customPerformance
    }

    GAME_BOM {
        string _id
        string gameId FK
        string baseBOMId FK
        number customMaterialCost
    }

    %% === TEAMS AND RUNS ===
    TEAM {
        string _id
        string gameId FK
        string name
        string[] studentIds
        date createdAt
    }

    RUN {
        string _id
        string teamId FK
        string gameId FK
        string configurationId FK
        string[] lineIds
        number teamCapital
        string status "in-progress | completed"
        date startedAt
        date endedAt
    }

    LINE {
        string _id
        string runId FK
        string name
        number throughput
        number downtime
        number quality
    }

    %% === RELATIONSHIPS ===
    INSTITUTION ||--o{ USER : "has"
    INSTITUTION ||--o{ PROFESSOR_REQUEST : "receives"
    USER ||--o{ CLASS : "creates"
    CLASS ||--o{ GROUP : "contains"
    GROUP ||--o{ GAME : "has"
    GAME ||--o{ TEAM : "creates"
    TEAM ||--o{ RUN : "produces"
    RUN ||--o{ LINE : "includes"
    GAME ||--o{ GAME_CONFIGURATION : "has"
    GAME_CONFIGURATION ||--o{ GAME_MACHINERY : "customizes"
    GAME_CONFIGURATION ||--o{ GAME_EMPLOYEE : "customizes"
    GAME_CONFIGURATION ||--o{ GAME_BOM : "customizes"
    INSTITUTION_REQUEST ||--|| INSTITUTION : "creates on approval"
